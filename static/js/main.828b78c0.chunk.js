(this.webpackJsonpyandex_map_demo=this.webpackJsonpyandex_map_demo||[]).push([[0],[,,,,,,,,,,,,,,,,function(e,n,t){},,function(e,n,t){},function(e,n,t){},,function(e,n,t){},function(e,n,t){},function(e,n,t){},function(e,n,t){"use strict";t.r(n);var r=t(1),c=t(9),a=t.n(c),o=t(11),u=t(4),i=t(5),s=(t(16),t(0));var l,d=function(e){var n=e.searchValueHandler,t=Object(r.useRef)();return Object(s.jsxs)("div",{className:"search_block",children:[Object(s.jsx)("input",{ref:t,placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043d\u0430\u0441\u0435\u043b\u0435\u043d\u043d\u043e\u0433\u043e \u043f\u0443\u043d\u043a\u0442\u0430"}),Object(s.jsx)("button",{onClick:function(){if(t.current){var e=t.current.value.trim();if(e)n(e)&&(t.current.value="")}},children:"\u041d\u0430\u0439\u0442\u0438 \u043a\u043e\u043e\u0440\u0434\u0438\u043d\u0430\u0442\u044b"})]})},f=t(2),j="d84a4169-1739-4ba8-a628-d3ca43063114&lang",m={lat:45.02,lon:38.59},p="pa",b=(l={},Object(f.a)(l,p,"\u041f\u043e\u0438\u0441\u043a \u043a\u043e\u043e\u0440\u0434\u0438\u043d\u0430\u0442..."),Object(f.a)(l,"atm","\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d \u043d\u0430 \u043a\u0430\u0440\u0442\u0443"),Object(f.a)(l,"ae","\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043d\u0430 \u043a\u0430\u0440\u0442\u0443"),l);t(18);var O=function(e){var n=e.point,t=e.clickHandler,r=e.removeHandler;return Object(s.jsxs)("li",{className:"point",onClick:function(){return t(n)},children:[Object(s.jsx)("span",{children:n.name}),Object(s.jsx)("span",{className:"point__status",children:b[n.mapStatus]}),Object(s.jsx)("button",{className:"point__remove_button",onClick:function(e){e.stopPropagation(),r(n)},children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"})]})};t(19);var h=function(e){var n=e.points,t=e.pointClickHandler,r=e.pointRemoveHandler;return Object(s.jsx)("ul",{className:"point_list",children:n.map((function(e){return Object(s.jsx)(O,{point:e,clickHandler:t,removeHandler:r},e.id)}))})},v=t(8),x=t.n(v),g=t(10);function y(){return(y=Object(g.a)(x.a.mark((function e(){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){if(window.ymaps)e(window.ymaps);else{var t="https://api-maps.yandex.ru/2.1/?apikey=".concat(j,"&lang=ru_RU"),r=document.createElement("script");r.src=t,r.async=!0,r.onload=function(){return window.ymaps.ready((function(){return e(window.ymaps)}))},r.onerror=function(e){return n(e)},document.body.appendChild(r)}})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,n="QWERTYUIOPASDFGHJKLZXCVBNMqwertyuiopasdfghjklzxcvbnm",t=[],r=0;r<e;r++)t.push(n[Math.floor(Math.random()*n.length)]);return t.join("")}function w(){var e=["OrangeRed","LimeGreen","DodgerBlue","BlueViolet","DimGrey"];return e[Math.floor(Math.random()*e.length)]}t(21);var _=function(){var e=Object(r.useState)(!0),n=Object(i.a)(e,2),t=n[0],c=n[1],a=Object(r.useState)(!1),l=Object(i.a)(a,2),f=l[0],j=l[1],b=Object(r.useState)(null),O=Object(i.a)(b,2),v=O[0],x=O[1],g=Object(r.useState)([]),_=Object(i.a)(g,2),C=_[0],H=_[1],S=Object(r.useRef)(null),N=Object(r.useRef)(null),R=Object(r.useRef)(null);Object(r.useEffect)((function(){navigator.geolocation.getCurrentPosition((function(e){return x({lat:e.coords.latitude,lon:e.coords.longitude})}),(function(){return x(m)}))}),[]),Object(r.useEffect)((function(){v&&function(){return y.apply(this,arguments)}().finally((function(){return c(!1)})).then((function(e){N.current=e,R.current=new e.Map(S.current,{center:[v.lat,v.lon],zoom:10,controls:["smallMapDefaultSet"]},{autoFitToViewport:"always"})})).catch((function(e){j(!0),console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u043a\u0430\u0440\u0442\u044b: ".concat(e))}))}),[v]),Object(r.useEffect)((function(){if(0!==C.length&&N.current&&R.current){var e=function(e){return H((function(n){return n.map((function(n){return n.id===e.id?e:n}))}))};C.forEach((function(n){n.mapStatus===p&&N.current.geocode(n.name).then((function(t){var r=t.geoObjects.get(0).geometry._coordinates,c=new N.current.Placemark(r,{},{preset:"islands#icon",iconColor:w()});c.events.add("click",(function(){return E(c)})),R.current.geoObjects.add(c),E(c),e(Object(u.a)(Object(u.a)({},n),{},{mark:c,mapStatus:"atm"}))})).catch((function(t){console.log("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0438\u0442\u044c \u043a\u043e\u043e\u0440\u0434\u0438\u043d\u0430\u0442\u044b \u0434\u043b\u044f ".concat(n.name," \u041e\u0448\u0438\u0431\u043a\u0430: ").concat(t)),e(Object(u.a)(Object(u.a)({},n),{},{mapStatus:"ae"}))}))}))}}),[C.length]);var E=function(e){R.current&&e&&R.current.panTo(e.geometry.getCoordinates()).then((function(){return R.current.setZoom(10,{duration:200})}))};return f?Object(s.jsx)("div",{className:"yandex_map",children:Object(s.jsx)("span",{children:"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u043a\u0430\u0440\u0442\u0443..."})}):Object(s.jsx)("div",{className:"yandex_map",children:t?Object(s.jsx)("span",{children:"\u0417\u0430\u0433\u0440\u0443\u0436\u0430\u044e \u043a\u0430\u0440\u0442\u0443..."}):Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(d,{searchValueHandler:function(e){return!C.some((function(n){return n.name.toLowerCase()===e.toLowerCase()}))&&(H((function(n){return[{id:k(),name:e,mark:null,mapStatus:p}].concat(Object(o.a)(n))})),!0)}}),C.length>0&&Object(s.jsx)(h,{points:C,pointClickHandler:function(e){return E(e.mark)},pointRemoveHandler:function(e){e.mark&&R.current&&R.current.geoObjects.remove(e.mark),H((function(n){return n.filter((function(n){return n.id!==e.id}))}))}}),Object(s.jsx)("div",{className:"yandex_map__map_container",ref:S})]})})};t(22);var C=function(){return Object(s.jsxs)("div",{className:"app",children:[Object(s.jsx)("header",{children:"\u041a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442 \u043a\u0430\u0440\u0442\u044b:"}),Object(s.jsx)(_,{})]})};t(23);a.a.render(Object(s.jsx)(C,{}),document.getElementById("root"))}],[[24,1,2]]]);
//# sourceMappingURL=main.828b78c0.chunk.js.map